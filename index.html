<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Popup Consentement Cookies</title>
<style>
  #cookie-popup {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #fff;
    border: 1px solid #333;
    padding: 20px;
    max-width: 400px;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
    z-index: 9999;
    font-family: Arial, sans-serif;
  }
  #cookie-popup p {
    margin-bottom: 15px;
    font-size: 14px;
    color: #333;
  }
  #cookie-popup button {
    padding: 8px 15px;
    margin-right: 10px;
    border: none;
    cursor: pointer;
    font-size: 14px;
  }
  #accept-btn {
    background-color: #4CAF50;
    color: white;
  }
  #reject-btn {
    background-color: #f44336;
    color: white;
  }
</style>
</head>
<body>

<div id="cookie-popup" style="display:none;">
  <p>En acceptant les cookies, vous consentez à la collecte de données afin de proposer des publicités moins génériques.</p>
  <button id="reject-btn">Refuser tous les cookies</button>
  <button id="accept-btn">Accepter tous les cookies</button>
</div>

<script>
  // Affiche le popup si pas de décision enregistrée
  if (!localStorage.getItem('cookieConsent')) {
    document.getElementById('cookie-popup').style.display = 'block';
  }

  document.getElementById('reject-btn').onclick = function() {
    localStorage.setItem('cookieConsent', 'rejected');
    document.getElementById('cookie-popup').style.display = 'none';
    // Ne rien collecter
    console.log("Cookies refusés : aucune donnée collectée.");
  };

  document.getElementById('accept-btn').onclick = function() {
    localStorage.setItem('cookieConsent', 'accepted');
    document.getElementById('cookie-popup').style.display = 'none';

    // Collecte maximale d'infos non bloquées par navigateur
    const data = {
      userAgent: navigator.userAgent,
      language: navigator.language,
      languages: navigator.languages,
      platform: navigator.platform,
      cookieEnabled: navigator.cookieEnabled,
      screenWidth: screen.width,
      screenHeight: screen.height,
      colorDepth: screen.colorDepth,
      timezoneOffset: new Date().getTimezoneOffset(),
      javaEnabled: navigator.javaEnabled(),
      online: navigator.onLine,
      hardwareConcurrency: navigator.hardwareConcurrency || 'non disponible',
    };

    // Ici tu peux envoyer ces données à ton serveur par fetch ou autre
    console.log("Cookies acceptés : données collectées", data);

    // Exemple d'envoi (à adapter) :
    /*
    fetch('/collect-cookie-data', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(data)
    });
    */
  };
</script>

</body>
</html>
